<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Python User Guide · </title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Perspective for Python uses the exact same C++ data engine used by the"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Python User Guide · "/><meta property="og:type" content="website"/><meta property="og:url" content="https://perspective.finos.org//index.html"/><meta property="og:description" content="Perspective for Python uses the exact same C++ data engine used by the"/><meta property="og:image" content="https://perspective.finos.org/img/perspective.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://perspective.finos.org/img/perspective.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai.min.css"/><link rel="alternate" type="application/atom+xml" href="https://perspective.finos.org/blog/atom.xml" title=" Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://perspective.finos.org/blog/feed.xml" title=" Blog RSS Feed"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:900&amp;display=swap"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://unpkg.com/@finos/perspective/dist/umd/perspective.js"></script><script type="text/javascript" src="https://unpkg.com/@finos/perspective-viewer/dist/umd/perspective-viewer.js"></script><script type="text/javascript" src="https://unpkg.com/@finos/perspective-viewer-hypergrid/dist/umd/perspective-viewer-hypergrid.js"></script><script type="text/javascript" src="https://unpkg.com/@finos/perspective-viewer-d3fc/dist/umd/perspective-viewer-d3fc.js"></script><script type="text/javascript" src="js/animation.js"></script><script type="text/javascript" src="js/logo.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.png" alt=""/><h2 class="headerTitleWithLogo"></h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/md/installation.html" target="_self">Docs</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class=""><a href="https://github.com/finos/perspective/" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Getting Started</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/md/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/md/js.html">Javascript User Guide</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/md/python.html">Python User Guide</a></li><li class="navListItem"><a class="navItem" href="/docs/md/styles.html">CSS Styles</a></li><li class="navListItem"><a class="navItem" href="/docs/md/development.html">Developer Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Javascript API</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/obj/perspective.html">perspective API</a></li><li class="navListItem"><a class="navItem" href="/docs/obj/perspective-viewer.html">perspective-viewer API</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Python API</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/obj/perspective-python.html">perspective-python API</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Python User Guide</h1></header><article><div><span><p>Perspective for Python uses the exact same C++ data engine used by the
<a href="https://perspective.finos.org/docs/md/js.html">WebAssembly version</a> The library
consists of many of the same abstractions and API as in Javascript, as well as
Python-specific data loading support for <a href="https://numpy.org/">NumPy</a>,
<a href="https://pandas.pydata.org/">Pandas</a> (and
<a href="https://arrow.apache.org/">Apache Arrow</a>, as in Javascript).</p>
<p>Additionally, <code>perspective-python</code> provides a session manager suitable for
integration into server systems such as
<a href="https://www.tornadoweb.org/en/stable/websocket.html">Tornado websockets</a>, which
allows fully <em>virtual</em> Perspective tables to be interacted with by multiple
<code>&lt;perspective-viewer&gt;</code> in a Web Browser. As <code>&lt;perspective-viewer&gt;</code> will only
consume the data necessary to render the current screen, this runtime mode
allows <em>ludicrous</em> <em>size</em> datasets with instant-load after they've been manifest
on the server (at the expense of network latency on UI interaction). The
included <code>PerspectiveWidget</code> allows running such a viewer in
<a href="https://jupyterlab.readthedocs.io/en/stable/">Jupyter Lab</a> in either server or
client (via WebAssembly) mode, and the included <code>PerspectiveTornadoHandler</code>
makes it simple to extend a Tornado server with virtual Perspective support.</p>
<p>The <code>perspective</code> module exports several tools:</p>
<ul>
<li><code>Table</code>, the table constructor for Perspective, which implements the <code>table</code>
and <code>view</code> API in the same manner as the Javascript library.</li>
<li><code>PerspectiveWidget</code> the JupyterLab widget for interactive visualization.</li>
<li><code>PerspectiveManager</code> the session manager for shared server deployment, with a
reference implementation in <a href="https://www.tornadoweb.org/">Tornado</a>.</li>
</ul>
<p>This user's guide provides an overview of the most common ways to use
Perspective in Python: the <code>Table</code> API, the JupyterLab widget, and the Tornado
handler. For more information, see
<a href="https://perspective.finos.org/docs/obj/perspective-viewer.html">Python API</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="table"></a><a href="#table" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>Table</code></h2>
<p>A <code>Table</code> can be created from a dataset or a schema, the specifics of which are
<a href="#loading-data-with-table">discussed</a> in the Javascript section of the user's
guide. In Python, however, Perspective supports additional data types that are
commonly used when processing data:</p>
<ul>
<li><code>pandas.DataFrame</code></li>
<li><code>numpy.ndarray</code></li>
<li><code>numpy.ndarray</code></li>
<li><code>bytes</code> (encoding an Apache Arrow)</li>
</ul>
<p>A <code>Table</code> is created in a similar fashion to its Javascript equivalent:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> date, datetime
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> perspective

data = pd.DataFrame({
    <span class="hljs-string">"int"</span>: np.arange(<span class="hljs-number">100</span>),
    <span class="hljs-string">"float"</span>: [i * <span class="hljs-number">1.5</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">100</span>)],
    <span class="hljs-string">"bool"</span>: [<span class="hljs-literal">True</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">100</span>)],
    <span class="hljs-string">"date"</span>: [date.today() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">100</span>)],
    <span class="hljs-string">"datetime"</span>: [datetime.now() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">100</span>)],
    <span class="hljs-string">"string"</span>: [str(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">100</span>)]
})
table = perspective.Table(data, index=<span class="hljs-string">"float"</span>)
</code></pre>
<p>Likewise, a <code>View</code> can be created via the <code>view()</code> method:</p>
<pre><code class="hljs css language-python">view = table.view(row_pivots=[<span class="hljs-string">"float"</span>], filter=[[<span class="hljs-string">"bool"</span>, <span class="hljs-string">"=="</span>, <span class="hljs-literal">True</span>]])
column_data = view.to_dict()
row_data = view.to_records()
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="pandas--numpy-support"></a><a href="#pandas--numpy-support" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pandas &amp; Numpy Support</h3>
<p>Perspective supports dictionaries of 1-dimensional <code>numpy.ndarray</code>, as well as
structured arrays and record arrays. When passing in dictionaries of NumPy
arrays, make sure that your dataset contains only NumPy arrays, and not a
mixture of arrays and Python lists — this will raise an exception. Numpy
structured/record arrays are parsed according to their field name and dtype.</p>
<p><code>Table</code> can aslo be constructed from <code>pandas.DataFrame</code> and <code>pandas.Series</code>
objects. Because Perspective is designed for applying its own transformations on
top of a flat dataset, dataframes that are passed in will be flattened and have
its <code>index</code> treated as another column (through the
<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.reset_index.html"><code>reset_index()</code></a>
method). If the dataframe does not have an index set, an integer-typed column
named <code>&quot;index&quot;</code> is created. If you want to preserve the indexing behavior of the
dataframe passed into Perspective, simply create the <code>Table</code> with
<code>index=&quot;index&quot;</code> as a keyword argument. This tells Perspective to once again
treat the index as a primary key:</p>
<pre><code class="hljs css language-python">data.set_index(<span class="hljs-string">"datetime"</span>)
table = perspective.Table(data, index=<span class="hljs-string">"index"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="schemas--supported-data-types"></a><a href="#schemas--supported-data-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Schemas &amp; Supported Data Types</h3>
<p>Unlike Javascript, where schemas must be created using string representations of
their types, <code>perspective-python</code> leverages Python's type system for schema
creation.</p>
<p>A schema can be created with the following types:</p>
<ul>
<li><code>int</code> (and <code>long</code> in Python 2)</li>
<li><code>float</code></li>
<li><code>bool</code></li>
<li><code>datetime.date</code></li>
<li><code>datetime.datetime</code></li>
<li><code>str</code> (and <code>unicode</code> in Python 2)</li>
</ul>
<p>Once the <code>Table</code> has been created with a schema, however, Perspective will cast
the data that it ingests to conform with the schema. This allows for a lot of
flexibility; a column that is typed as a <code>datetime</code>, for example, can be updated
with <code>date</code> objects, <code>datetime</code> objects, <code>pandas.Timestamp</code>, <code>numpy.datetime64</code>,
and even valid millisecond/seconds from epoch timestamps. Similarly, updating
string columns with integer data will cause a cast to string, updating floats
with ints cause a float cast, and etc.</p>
<p>Type inferrence works similarly—a column that contains <code>pandas.Timestamp</code>
objects will have its type inferred as <code>datetime</code>, which allows it to be updated
with any of the datetime types that were just mentioned. Thus, Perspective is
aware of the basic type primitives that it supports, but agnostic towards the
actual Python <code>type</code> of the data that it receives.</p>
<h3><a class="anchor" aria-hidden="true" id="callbacks-and-events"></a><a href="#callbacks-and-events" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Callbacks and Events</h3>
<p><code>perspective.Table</code> allows for <code>on_update</code> and <code>on_delete</code> callbacks to be
set—simply call <code>on_update</code> or <code>on_delete</code> with a reference to a function or a
lambda without any parameters:</p>
<pre><code class="hljs css language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">callback</span><span class="hljs-params">()</span>:</span>
    print(<span class="hljs-string">"Updated!"</span>)
view.on_update(callback)
view.on_delete(<span class="hljs-keyword">lambda</span>: print(<span class="hljs-string">"Updated again!"</span>))
</code></pre>
<p>If the callback is a named reference to a function, it can be removed with
<code>remove_update</code> or <code>remove_delete</code>. Callbacks defined with a lambda function
cannot be removed at this time.</p>
<pre><code class="hljs css language-python">view.remove_update(callback)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="perspectivewidget"></a><a href="#perspectivewidget" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>PerspectiveWidget</code></h2>
<p>Building on top of the API provided by <code>perspective.Table</code>, the
<code>PerspectiveWidget</code> is a JupyterLab plugin that offers the entire functionality
of Perspective within the Jupyter environment. It supports the same API
semantics of <code>&lt;perspective-viewer&gt;</code>, along with the additional data types
supported by <code>perspective.Table</code>.</p>
<p>Additionally, when created with <code>client=true</code> as a keyword argument to
<code>__init__</code>, it can be used without accessing the built C++ binary.</p>
<h2><a class="anchor" aria-hidden="true" id="client-mode"></a><a href="#client-mode" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Client Mode</h2>
<p>For certain systems, it may be difficult or infeasible to build the C++ library
for Perspective, which <code>perspective.Table</code> depends on. However, we can leverage
<code>Perspective.js</code> in the browser to provide the same widget experience to users.
If created with <code>client=true</code>, <code>PerspectiveWidget</code> will serialize the data to
the best of its ability and pass it off to the browser's Perspective engine to
load.</p>
<p>If <code>perspective-python</code> cannot find the built C++ libraries, it automatically
defaults to client mode when initializing the widget.</p>
<h2><a class="anchor" aria-hidden="true" id="perspectivewidget-1"></a><a href="#perspectivewidget-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>PerspectiveWidget</code></h2>
<p>Similar to the viewer API, <code>PerspectiveWidget</code> takes keyword arguments that
transform the <code>View</code> under ownsership:</p>
<ul>
<li><code>plugin</code></li>
<li><code>row_pivots</code></li>
<li><code>column_pivots</code></li>
<li><code>columns</code></li>
<li><code>aggregates</code></li>
<li><code>sort</code></li>
<li><code>filters</code></li>
</ul>
<p>Arguments that will be passed to the <code>Table</code> constructor if a dataset or schema
is passed in:</p>
<ul>
<li><a href="#index-and-limit"><code>index</code></a></li>
<li><a href="#index-and-limit"><code>limit</code></a></li>
</ul>
<p>As well as keyword arguments specific to <code>PerspectiveWidget</code> itself:</p>
<ul>
<li><code>client</code>: a boolean that determines whether the Widget will depend on <code>Table</code>
in Python, or if it sends data to the front-end WebAssembly engine for
processing.</li>
</ul>
<p>Several Enums are provided to make lookup of specific plugin types, aggregate
types, etc. much easier:</p>
<ul>
<li><a href="https://github.com/finos/perspective/blob/master/python/perspective/perspective/core/aggregate.py"><code>Aggregate</code></a>
: aggregate operations</li>
<li><a href="https://github.com/finos/perspective/blob/master/python/perspective/perspective/core/sort.py"><code>Sort</code></a>
: sort directions</li>
<li><a href="https://github.com/finos/perspective/blob/master/python/perspective/perspective/core/plugin.py"><code>Plugin</code></a>
: plugins (grid/chart types, etc.)</li>
</ul>
<p>These can be used as replacements to string values in the API:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> perspective <span class="hljs-keyword">import</span> PerspectiveWidget, Aggregate, Sort, Plugin
w = perspective.PerspectiveWidget(
    data, plugin=Plugin.XBAR, aggregates={<span class="hljs-string">"datetime"</span>: Aggregate.ANY})
w.sort = [[<span class="hljs-string">"date"</span>, Sort.DESC]]
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="creating-a-widget"></a><a href="#creating-a-widget" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating a widget</h2>
<p>A widget is created through the <code>PerspectiveWidget</code> constructor, which takes as
its first, required parameter a <code>perspective.Table</code>, a dataset, a schema, or
<code>None</code>, which serves as a special value that tells the Widget to defer loading
any data until later. In maintaining consistency with the Javascript API,
Widgets cannot be created with empty dictionaries or lists—<code>None</code> should be used
if the intention is to await data for loading later on.</p>
<p>A widget can be constructed from a dataset:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> perspective <span class="hljs-keyword">import</span> PerspectiveWidget, Table
widget = PerspectiveWidget(data, row_pivots=[<span class="hljs-string">"date"</span>])
</code></pre>
<p>Or a schema:</p>
<pre><code class="hljs css language-python">widget = PerspectiveWidget({<span class="hljs-string">"a"</span>: int, <span class="hljs-string">"b"</span>: str})
</code></pre>
<p>Or an instance of a <code>perspective.Table</code>:</p>
<pre><code class="hljs css language-python">table = Table(data)
widget = PerspectiveWidget(table)
</code></pre>
<p>Or <code>None</code>:</p>
<pre><code class="hljs css language-python">widget = PerspectiveWidget(<span class="hljs-literal">None</span>)
</code></pre>
<p>Once the widget has been created, simply call it in order to render the widget's
front-end <code>&lt;perspective-viewer&gt;</code>:</p>
<pre><code class="hljs css language-python">widget
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="load"></a><a href="#load" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>load()</code></h2>
<p>Calling <code>load()</code> on the widget provides it with a dataset. If the widget already
has a dataset, and the new data has different columns to the old one, then the
widget state (pivots, sort, etc.) is cleared to prevent applying settings on
columns that don't exist.</p>
<p>Like <code>__init__</code>, load accepts a <code>perspective.Table</code>, a dataset, or a schema. If
running in client mode, <code>load</code> defers to the browser's Perspective engine. This
means that loading Python-only datasets, especially ones that cannot be
serialized into JSON, may cause some issues.</p>
<pre><code class="hljs css language-python">widget = PerspectiveWidget(<span class="hljs-literal">None</span>)
widget.load(data)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="update"></a><a href="#update" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>update()</code></h2>
<p>Call <code>update()</code> on the widget to update it with new data. When called in client
mode, this method serializes the data and passes it off to the Perspective
engine running in the browser.</p>
<pre><code class="hljs css language-python">widget.update(data)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="clear-and-replace"></a><a href="#clear-and-replace" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>clear()</code> and <code>replace()</code></h3>
<p>Calling <code>clear()</code> on the widget will remove all data from the underlying
<code>Table</code>, but preserve all user-applied settings to the widget.</p>
<pre><code class="hljs css language-python">widget.clear()
widget.table.size() <span class="hljs-comment"># True</span>
</code></pre>
<p>Calling <code>replace(data)</code> on the widget with new data will remove the table's old
data, and replace it with the new dataset, while preserving all widget state.</p>
<pre><code class="hljs css language-python">widget.replace(df2)
</code></pre>
<p>Both methods do not change the schema of the Table, so new data must conform to
the schema.</p>
<h3><a class="anchor" aria-hidden="true" id="reset"></a><a href="#reset" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>reset()</code></h3>
<p>Call <code>reset()</code> on the widget to return it to an unpivoted, unmodified state. The
<code>Table</code> that contains the widget's data is not affected.</p>
<pre><code class="hljs css language-python">widget = PerspectiveWidget(data, row_pivots=[<span class="hljs-string">"date"</span>], plugin=Plugin.XBAR)
widget.reset()
widget.plugin  <span class="hljs-comment"># "hypergrid"</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="perspectivetornadohandler"></a><a href="#perspectivetornadohandler" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>PerspectiveTornadoHandler</code></h2>
<p>Perspective ships with a pre-built Tornado handler that makes integration with
<code>tornado.websockets</code> extremely easy. This allows you to run an instance of
<code>Perspective</code> on a server using Python, open a websocket to a <code>Table</code>, and
access the <code>Table</code> in Javascript and through <code>&lt;perspective-viewer&gt;</code>.</p>
<p>All instructions sent to the <code>Table</code> are processed in Python, which executes the
commands, and returns its output through the websocket back to Javascript.</p>
<h3><a class="anchor" aria-hidden="true" id="python-setup"></a><a href="#python-setup" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python setup</h3>
<p>To use the handler, we need to first have an instance of a <code>Table</code> and a
<code>PerspectiveManager</code>—the manager acts as the interface between the Javascript
and the Python layers, implementing a JSON API that allows the two Perspective
runtimes to communicate.</p>
<pre><code class="hljs css language-python">MANAGER = PerspectiveManager()
</code></pre>
<p>Once the manager has been created, create a <code>Table</code> instance and call
<code>host_table</code> on the manager with a name, passing through a reference to the
<code>Table</code> you just created. <code>host_table()</code> registers the Table with the manager
and allows the manager to send instructions to the Table.</p>
<p>The name that you host the table under is important—it acts as a unique accessor
on the Javascript side, which will look for a Table hosted at the websocket with
the name you specify.</p>
<pre><code class="hljs css language-python">TABLE = Table(data)
MANAGER.host_table(<span class="hljs-string">"data_source_one"</span>, TABLE)
</code></pre>
<p>After the manager and table setup is complete, create a websocket endpoint and
provide it a reference to PerspectiveTornadoHandler. You must provide the
configuration object in the route tuple, and it must contain <code>manager</code>, which is
a reference to the <code>PerspectiveManager</code> you just created.</p>
<pre><code class="hljs css language-python">app = tornado.web.Application([
    (<span class="hljs-string">r"/"</span>, MainHandler),
    <span class="hljs-comment"># create a websocket endpoint that the client Javascript can access</span>
    (<span class="hljs-string">r"/websocket"</span>, PerspectiveTornadoHandler, {<span class="hljs-string">"manager"</span>: MANAGER, <span class="hljs-string">"check_origin"</span>: <span class="hljs-literal">True</span>})
])
</code></pre>
<p>Optionally, the configuration object can also include <code>check_origin</code>, a boolean
that determines whether the websocket accepts requests from origins other than
where the server is hosted. See
<a href="https://www.tornadoweb.org/en/stable/websocket.html#tornado.websocket.WebSocketHandler.check_origin">Tornado docs</a>
for more details.</p>
<h3><a class="anchor" aria-hidden="true" id="javascript-setup"></a><a href="#javascript-setup" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Javascript setup</h3>
<p>Once the server is up and running, you can access the Table you just hosted
using <code>perspective.websocket</code> and <code>open_table()</code>. First create a client that
expects a Perspective server to accept connections at the specified URL:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> websocket = perspective.websocket(<span class="hljs-string">"ws://localhost:8888/websocket"</span>);
</code></pre>
<p>Next open the <code>Table</code> we created on the server by name:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> table = websocket.open_table(<span class="hljs-string">"data_source_one"</span>);
</code></pre>
<p><code>table</code> is a proxy for the <code>Table</code> we created on the server. All operations that
are possible through the Javascript API are possible on the Python API as well,
thus calling <code>view()</code>, <code>schema()</code>, <code>update()</code> etc on <code>const table</code> will pass
those operations to the Python <code>Table</code>, execute the commands, and return the
result back to Javascript. Similarly, providing this <code>table</code> to a
<code>&lt;perspective-viewer&gt;</code> instance will allow virtual rendering:</p>
<pre><code class="hljs css language-javascript">viewer.load(table);
viewer.toggleConfig();
</code></pre>
<p><code>perspective.websocket</code> expects a Websocket URL where it will send instructions.
When <code>open_table</code> is called, the name to a hosted Table is passed through, and a
request is sent through the socket to fetch the Table. No actual Table instance
is passed inbetween the runtimes; all instructions are proxied through
websockets.</p>
<p>This provides for great flexibility — while <code>Perspective.js</code> is full of
features, browser WebAssembly runtimes currently have some performance
restrictions on memory and CPU feature utilization, and the architecture in
general suffers when the dataset itself is too large to download to the client
in full.</p>
<p>The Python runtime does not suffer from memory limitations, utilizes
<a href="https://github.com/intel/tbb">TBB</a> for threading and parallel processing, and
generates architecture optimized code, which currently makes it more suitable as
a server-side runtime than <code>node.js</code>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/md/js.html"><span class="arrow-prev">← </span><span>Javascript User Guide</span></a><a class="docs-next button" href="/docs/md/styles.html"><span>CSS Styles</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#table"><code>Table</code></a><ul class="toc-headings"><li><a href="#pandas--numpy-support">Pandas &amp; Numpy Support</a></li><li><a href="#schemas--supported-data-types">Schemas &amp; Supported Data Types</a></li><li><a href="#callbacks-and-events">Callbacks and Events</a></li></ul></li><li><a href="#perspectivewidget"><code>PerspectiveWidget</code></a></li><li><a href="#client-mode">Client Mode</a></li><li><a href="#perspectivewidget-1"><code>PerspectiveWidget</code></a></li><li><a href="#creating-a-widget">Creating a widget</a></li><li><a href="#load"><code>load()</code></a></li><li><a href="#update"><code>update()</code></a><ul class="toc-headings"><li><a href="#clear-and-replace"><code>clear()</code> and <code>replace()</code></a></li><li><a href="#reset"><code>reset()</code></a></li></ul></li><li><a href="#perspectivetornadohandler"><code>PerspectiveTornadoHandler</code></a><ul class="toc-headings"><li><a href="#python-setup">Python setup</a></li><li><a href="#javascript-setup">Javascript setup</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"></a><div><h5>Docs</h5><a href="/docs/en/md/installation.html">Installation</a><a href="/docs/en/md/usage.html">Usage</a><a href="/docs/en/obj/perspective.html">Perspective API</a><a href="/docs/en/obj/perspective-viewer.html">Perspective Viewer API</a><a href="/docs/en/obj/perspective-python-table.html">Perspective Python API</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/finos/perspective/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2020 Perspective Authors</section></footer></div></body></html>